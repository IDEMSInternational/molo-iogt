
{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags comments i18n%}

{% block content %}
{% if search_results %}
<h2 class="heading heading--search">{% trans "Search Results for:" %} &quot;{{search_query}}&quot;</h2>
	<div class="search search--result">
	{% for page in search_results %}
		{% with parent_section=page.get_parent_section ancestor=page.get_parent_section.get_ancestors.last %}
		{% if ancestor.sectionpage.image %}
		<div class="search--results-list search--results-list{{page.get_parent_section.get_effective_extra_style_hints}}">
			<a href="{% pageurl page %}" class="search__result-item">
				<h3 class="search--result__section-title">{{ancestor.title}}</h3>
				<h1 class="search--result__title">{{page.title}}</h3>
				<p class="search--result__subtitle">{{page.subtitle}}</p>
			</a>
		{% else %}
			<a href="{% pageurl page %}">
				<h3 class="search--result__section-title">{{parent_section.title}}</h3>
					<h1 class="search--result__title">{{page.title}}</h1>
					<p class="search--result__subtitle">{{page.subtitle}}</p>
			</a>
		{% endif %}
		{% get_comment_count for page as comment_count %}
		{% if comment_count > 0 %}
			<a href="{% pageurl page %}#comments-list" class="article-list__comments-counter">
				{{comment_count}}
				<span class="comment-counter__text">{% trans "comment" %}{{comment_count|pluralize}}</span>
			</a>
		</div>
		{% endif %}
		{% endwith %}
	{% endfor %}

	<div class="pagination">
		{% if search_results.has_previous %}
				<a href="?p={{ search_results.previous_page_number }}&amp;q={{search_query}}" class="pagination__link">&larr;</a>
		{% endif %}
		<span class="pagination__link pagination__link--current">Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}</span>
		{% if search_results.has_next %}
				<a href="?p={{ search_results.next_page_number }}&amp;q={{search_query}}" class="pagination__link">&rarr;</a>
		{% endif %}
	</div>
</div>
{% else %}
	<form action="{% url 'search' %}" id="search-form" class="search-form search-form--main">
		<input placeholder="{% trans "I am looking for" %}" name="q" type="search">
		<input type="submit" value="{% trans "Search"%}">
	</form>
	<h2 class="heading heading--search">{% trans "Search" %}</h2>
	<div class="search">
		<h3 class="search__feedback-title">
			{% trans "No search results for " %} {{search_query}}
		</h3>
		<a href="/" class="call-to-action__nav-item call-to-action__nav-item--back-home">
			{% trans "Back to homepage" %}
		</a>
	</div>
{% endif %}
{% endblock %}

{% block search %}
	{% if search_results %}
			{% include "search/search_block.html" %}
	{% endif %}
{% endblock %}


