{% load wagtailcore_tags wagtailimages_tags comments static core_tags i18n %}

{% if sections %}
<h3 class="heading heading--homepage">{% trans "Recommended" %}</h3>
<div class="section-list section-list__homepage">
  {% for section in sections %}
    {% load_descendant_articles_for_section section featured_in_homepage=True as featured_articles %}
    {% if featured_articles %}
    <div class="section-list__item section-list__item{{section.get_effective_extra_style_hints}}">
      <ul class="article-list">
      {% for article in featured_articles %}
      <li class="article-list__item">
      {% if forloop.first %}
        <div class="article_thumbnail--hero">
          <a href="{% pageurl article %}">
            {% if article.image %}
              {% image article.image width-320 %}
            {% endif %}
          </a>
        </div>
        <div class="article_content--hero">
          <a href="{% pageurl article %}">
              <h3 class="article__category--title">{{section.title}}</h3>
              <h2 class="article__title">{{article.title}}</h2>
              <p>{{article.subtitle}}</p>
          </a>
        </div>
      {% else %}
        <div class="article_thumbnail">
          <a href="{% pageurl article %}">
            {% if article.image %}
              {% image article.image width-90 height-90 class="" %}
            {% endif %}
          </a>
        </div>
        <div class="article_content">
          <a href="{% pageurl article %}">
              <h3 class="article__category--title">{{section.title}}</h3>
              <h2 class="article__title">{{article.title}}</h2>
              <p>{{article.subtitle}}</p>
          </a>
        </div>
      {% endif %}
      <p>{% get_comment_count for article as comment_count %}</p>
      {% if comment_count > 0 %}
          <div class="comments-count">
          <a href="{% pageurl featured %}#comments-list">
            {{comment_count}} 
            <span>{% trans "comment" %}{{comment_count|pluralize}}</span>
          </a></div>
      {% endif %}
      </li>

    {% endfor%}
    </ul>
    </div>
  {% endif %}
  {% endfor %}
</div>   
{% endif %}

